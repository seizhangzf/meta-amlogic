From bfab8b5feb10f7fd2e02f2a1de1f08c7ad8dd9d6 Mon Sep 17 00:00:00 2001
From: Matthew Shyu <matthew.shyu@amlogic.com>
Date: Mon, 12 Dec 2016 17:54:20 +0800
Subject: [PATCH] fix compilation on gcc6

---
 rtl8189ES/core/rtw_iol.c                |  3 ++-
 rtl8189ES/core/rtw_mlme_ext.c           |  4 ++--
 rtl8189ES/core/rtw_security.c           |  8 ++++----
 rtl8189ES/include/ieee80211.h           |  6 +++---
 rtl8189ES/os_dep/linux/ioctl_cfg80211.c | 10 +++++-----
 5 files changed, 16 insertions(+), 15 deletions(-)

diff --git a/rtl8189ES/core/rtw_iol.c b/rtl8189ES/core/rtw_iol.c
index 3524e1c..b9c7f48 100644
--- a/rtl8189ES/core/rtw_iol.c
+++ b/rtl8189ES/core/rtw_iol.c
@@ -258,7 +258,8 @@ void rtw_IOL_cmd_buf_dump(ADAPTER *Adapter,int buf_len,u8 *pbuf)
 	for(i=0;i< buf_len;i++){
 		printk("%02x-",*(pbuf+i));
 			
-		if(j%32 ==0) printk("\n");j++;				
+		if(j%32 ==0) printk("\n");
+		j++;
 	}
 	printk("\n");
 	printk("============= ioreg_cmd len = %d =============== \n",buf_len);	
diff --git a/rtl8189ES/core/rtw_mlme_ext.c b/rtl8189ES/core/rtw_mlme_ext.c
index 066fdbf..da60008 100755
--- a/rtl8189ES/core/rtw_mlme_ext.c
+++ b/rtl8189ES/core/rtw_mlme_ext.c
@@ -12121,10 +12121,10 @@ void rtw_delba_check(_adapter *padapter, struct sta_info *psta, u8 from_timer)
 							ret = issue_del_ba_ex(padapter, psta->hwaddr, i, 39, 0, 3, 1);
 						else
 							issue_del_ba(padapter,  psta->hwaddr, i, 39, 0);							
-							psta->recvreorder_ctrl[i].enable = _FALSE;
+						psta->recvreorder_ctrl[i].enable = _FALSE;
 						if (ret != _FAIL)
 							psta->recvreorder_ctrl[i].ampdu_size = RX_AMPDU_SIZE_INVALID;
-							rtw_reset_continual_no_rx_packet(psta, i);
+						rtw_reset_continual_no_rx_packet(psta, i);
 						}				
 					}
 				}
diff --git a/rtl8189ES/core/rtw_security.c b/rtl8189ES/core/rtw_security.c
index 0729501..5605d55 100644
--- a/rtl8189ES/core/rtw_security.c
+++ b/rtl8189ES/core/rtw_security.c
@@ -1595,8 +1595,8 @@ _func_enter_;
     for (j = 0 ; j < 8; j++) mic[j] = aes_out[j];
 
     /* Insert MIC into payload */
-    for (j = 0; j < 8; j++)
-    	pframe[payload_index+j] = mic[j];	//message[payload_index+j] = mic[j];
+	for (j = 0; j < 8; j++)
+		pframe[payload_index+j] = mic[j];	//message[payload_index+j] = mic[j];
 
 	payload_index = hdrlen + 8;
 	for (i=0; i< num_blocks; i++)
@@ -1981,8 +1981,8 @@ _func_enter_;
     for (j = 0 ; j < 8; j++) mic[j] = aes_out[j];
 
     /* Insert MIC into payload */
-    for (j = 0; j < 8; j++)
-    	message[payload_index+j] = mic[j];
+	for (j = 0; j < 8; j++)
+		message[payload_index+j] = mic[j];
 
 	payload_index = hdrlen + 8;
 	for (i=0; i< num_blocks; i++)
diff --git a/rtl8189ES/include/ieee80211.h b/rtl8189ES/include/ieee80211.h
index 9758e10..eaa0c48 100644
--- a/rtl8189ES/include/ieee80211.h
+++ b/rtl8189ES/include/ieee80211.h
@@ -1318,18 +1318,18 @@ enum ieee80211_state {
 (((Addr[2]) & 0xff) == 0xff) && (((Addr[3]) & 0xff) == 0xff) && (((Addr[4]) & 0xff) == 0xff) && \
 (((Addr[5]) & 0xff) == 0xff))
 #else
-extern __inline int is_multicast_mac_addr(const u8 *addr)
+static __inline int is_multicast_mac_addr(const u8 *addr)
 {
         return ((addr[0] != 0xff) && (0x01 & addr[0]));
 }
 
-extern __inline int is_broadcast_mac_addr(const u8 *addr)
+static __inline int is_broadcast_mac_addr(const u8 *addr)
 {
 	return ((addr[0] == 0xff) && (addr[1] == 0xff) && (addr[2] == 0xff) &&   \
 		(addr[3] == 0xff) && (addr[4] == 0xff) && (addr[5] == 0xff));
 }
 
-extern __inline int is_zero_mac_addr(const u8 *addr)
+static __inline int is_zero_mac_addr(const u8 *addr)
 {
 	return ((addr[0] == 0x00) && (addr[1] == 0x00) && (addr[2] == 0x00) &&   \
 		(addr[3] == 0x00) && (addr[4] == 0x00) && (addr[5] == 0x00));
diff --git a/rtl8189ES/os_dep/linux/ioctl_cfg80211.c b/rtl8189ES/os_dep/linux/ioctl_cfg80211.c
index 46934d0..25eb84a 100644
--- a/rtl8189ES/os_dep/linux/ioctl_cfg80211.c
+++ b/rtl8189ES/os_dep/linux/ioctl_cfg80211.c
@@ -5267,11 +5267,11 @@ static int _cfg80211_rtw_mgmt_tx(_adapter *padapter, u8 tx_ch, const u8 *buf, si
 	}else 
 #endif //CONFIG_CONCURRENT_MODE
 	//if (tx_ch != pmlmeext->cur_channel) {
-	if(tx_ch != rtw_get_oper_ch(padapter)) {
-		if (!check_fwstate(&padapter->mlmepriv, _FW_LINKED ))
-			pmlmeext->cur_channel = tx_ch;
-		set_channel_bwmode(padapter, tx_ch, HAL_PRIME_CHNL_OFFSET_DONT_CARE, CHANNEL_WIDTH_20);
-	}
+		if(tx_ch != rtw_get_oper_ch(padapter)) {
+			if (!check_fwstate(&padapter->mlmepriv, _FW_LINKED ))
+				pmlmeext->cur_channel = tx_ch;
+			set_channel_bwmode(padapter, tx_ch, HAL_PRIME_CHNL_OFFSET_DONT_CARE, CHANNEL_WIDTH_20);
+		}
 
 	//starting alloc mgmt frame to dump it
 	if ((pmgntframe = alloc_mgtxmitframe(pxmitpriv)) == NULL)
-- 
2.11.0

