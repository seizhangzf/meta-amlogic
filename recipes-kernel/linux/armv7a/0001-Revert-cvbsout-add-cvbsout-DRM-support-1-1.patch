From 603d543f5149b6367d6121d48f4f07f6067d89ca Mon Sep 17 00:00:00 2001
From: Pradeep Sriram <pradeep.sriram@amlogic.com>
Date: Thu, 9 Apr 2020 12:02:34 -0700
Subject: [PATCH 1/8] Revert "cvbsout: add cvbsout DRM support [1/1]"

This reverts commit 306d1cd0fd9baef5d8669e9a5a87b742fd4753f7.
---
 .../g12a_s905d2_u200_drm_buildroot.dts        |   8 -
 .../g12a_s905x2_u212_drm_buildroot.dts        |   4 -
 .../amlogic/g12b_a311d_w400_drm_buildroot.dts |   4 -
 .../g12b_a311d_w400_drm_buildroot_a.dts       |   4 -
 .../g12b_revb_a311d_w400_drm_buildroot.dts    |   4 -
 arch/arm/boot/dts/amlogic/meson_drm.dtsi      |  22 +-
 arch/arm/boot/dts/amlogic/mesong12a_drm.dtsi  |  22 +-
 arch/arm/boot/dts/amlogic/mesong12b_drm.dtsi  |  22 +-
 arch/arm/boot/dts/amlogic/mesonsm1_drm.dtsi   |  22 +-
 arch/arm/boot/dts/amlogic/mesontl1_drm.dtsi   |  22 +-
 arch/arm/boot/dts/amlogic/mesontm2_drm.dtsi   |  22 +-
 .../sm1_s905d3_ac200_drm_buildroot.dts        |   4 -
 .../dts/amlogic/tl1_t962x2_x301_1g_drm.dts    |   4 -
 .../dts/amlogic/tl1_t962x2_x301_2g_drm.dts    |   4 -
 .../boot/dts/amlogic/tm2_t962e2_ab311_drm.dts |   4 -
 .../tm2_t962e2_ab311_drm_buildroot.dts        |   4 -
 .../boot/dts/amlogic/tm2_t962x3_ab301_drm.dts |   4 -
 .../tm2_t962x3_ab301_drm_buildroot.dts        |   4 -
 .../g12a_s905d2_u200_drm_buildroot.dts        |   8 -
 .../g12a_s905x2_u212_drm_buildroot.dts        |   4 -
 .../amlogic/g12b_a311d_w400_drm_buildroot.dts |   4 -
 .../g12b_a311d_w400_drm_buildroot_a.dts       |   4 -
 .../g12b_revb_a311d_w400_drm_buildroot.dts    |   4 -
 .../dts/amlogic/gxl_p212_2g_drm_buildroot.dts |   4 -
 arch/arm64/boot/dts/amlogic/meson_drm.dtsi    |  22 +-
 .../arm64/boot/dts/amlogic/mesong12a_drm.dtsi |  22 +-
 .../arm64/boot/dts/amlogic/mesong12b_drm.dtsi |  22 +-
 arch/arm64/boot/dts/amlogic/mesonsm1_drm.dtsi |  22 +-
 arch/arm64/boot/dts/amlogic/mesontl1_drm.dtsi |  22 +-
 arch/arm64/boot/dts/amlogic/mesontm2_drm.dtsi |  22 +-
 .../sm1_s905d3_ac200_drm_buildroot.dts        |   4 -
 .../dts/amlogic/tl1_t962x2_x301_1g_drm.dts    |   5 -
 .../dts/amlogic/tl1_t962x2_x301_2g_drm.dts    |   4 -
 .../boot/dts/amlogic/tm2_t962e2_ab311_drm.dts |   4 -
 .../tm2_t962e2_ab311_drm_buildroot.dts        |   4 -
 .../boot/dts/amlogic/tm2_t962x3_ab301_drm.dts |   4 -
 .../tm2_t962x3_ab301_drm_buildroot.dts        |   4 -
 drivers/amlogic/drm/Kconfig                   |  11 -
 drivers/amlogic/drm/Makefile                  |   4 -
 drivers/amlogic/drm/meson_cvbs.c              | 338 ------------------
 drivers/amlogic/drm/meson_cvbs.h              |  37 --
 drivers/amlogic/drm/meson_vpu.c               |   1 -
 drivers/amlogic/media/vout/cvbs/cvbs_mode.h   |   2 +
 drivers/amlogic/media/vout/cvbs/cvbs_out.c    |   6 +-
 drivers/amlogic/media/vout/cvbs/wss.c         |   2 +-
 include/linux/amlogic/media/vout/cvbs_out.h   |  39 --
 46 files changed, 17 insertions(+), 796 deletions(-)
 delete mode 100644 drivers/amlogic/drm/meson_cvbs.c
 delete mode 100644 drivers/amlogic/drm/meson_cvbs.h
 delete mode 100644 include/linux/amlogic/media/vout/cvbs_out.h

diff --git a/arch/arm/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts b/arch/arm/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts
index ab2cc9abbc7f..726780506e72 100644
--- a/arch/arm/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts
+++ b/arch/arm/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts
@@ -827,10 +827,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "okay";
 };
@@ -1479,10 +1475,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts b/arch/arm/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts
index 94ddce32e55a..fa5319876b81 100644
--- a/arch/arm/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts
+++ b/arch/arm/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts
@@ -1451,10 +1451,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts b/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts
index 608aafeb7716..1a9a40d1c6a4 100644
--- a/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts
+++ b/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts
@@ -1524,10 +1524,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts b/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts
index 2a970680f35f..e889c24707f5 100644
--- a/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts
+++ b/arch/arm/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts
@@ -1489,10 +1489,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts b/arch/arm/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts
index 309f587afef9..3e069bcca034 100644
--- a/arch/arm/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts
+++ b/arch/arm/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts
@@ -1464,10 +1464,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm/boot/dts/amlogic/meson_drm.dtsi b/arch/arm/boot/dts/amlogic/meson_drm.dtsi
index 7071bd9854f7..9f391ba1e3c5 100644
--- a/arch/arm/boot/dts/amlogic/meson_drm.dtsi
+++ b/arch/arm/boot/dts/amlogic/meson_drm.dtsi
@@ -34,22 +34,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -83,11 +67,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm/boot/dts/amlogic/mesong12a_drm.dtsi b/arch/arm/boot/dts/amlogic/mesong12a_drm.dtsi
index 3a4d09fc2e8e..8948d6d917b9 100644
--- a/arch/arm/boot/dts/amlogic/mesong12a_drm.dtsi
+++ b/arch/arm/boot/dts/amlogic/mesong12a_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm/boot/dts/amlogic/mesong12b_drm.dtsi b/arch/arm/boot/dts/amlogic/mesong12b_drm.dtsi
index 58638e14224c..cd282538a511 100644
--- a/arch/arm/boot/dts/amlogic/mesong12b_drm.dtsi
+++ b/arch/arm/boot/dts/amlogic/mesong12b_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm/boot/dts/amlogic/mesonsm1_drm.dtsi b/arch/arm/boot/dts/amlogic/mesonsm1_drm.dtsi
index 082b8f9fd229..0c7f6d584226 100644
--- a/arch/arm/boot/dts/amlogic/mesonsm1_drm.dtsi
+++ b/arch/arm/boot/dts/amlogic/mesonsm1_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm/boot/dts/amlogic/mesontl1_drm.dtsi b/arch/arm/boot/dts/amlogic/mesontl1_drm.dtsi
index 770d3b89bc25..7c5bf85dfc2a 100644
--- a/arch/arm/boot/dts/amlogic/mesontl1_drm.dtsi
+++ b/arch/arm/boot/dts/amlogic/mesontl1_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm/boot/dts/amlogic/mesontm2_drm.dtsi b/arch/arm/boot/dts/amlogic/mesontm2_drm.dtsi
index a79838750dad..0c753f87aace 100644
--- a/arch/arm/boot/dts/amlogic/mesontm2_drm.dtsi
+++ b/arch/arm/boot/dts/amlogic/mesontm2_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts b/arch/arm/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts
index 86b87837f70e..8f8b247d6f5d 100644
--- a/arch/arm/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts
+++ b/arch/arm/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts
@@ -1110,10 +1110,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disabled";
 };
diff --git a/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts b/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts
index a01a62abd098..3c8a80bb84a7 100644
--- a/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts
+++ b/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts
@@ -1918,10 +1918,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts b/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts
index 63297b06321e..ea1afcab9db0 100644
--- a/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts
+++ b/arch/arm/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts
@@ -1914,10 +1914,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts b/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts
index 050d42f9474b..1647789534d0 100644
--- a/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts
+++ b/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts
@@ -1870,10 +1870,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disabled";
 };
diff --git a/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts b/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts
index ce8e89785695..6a8b59c57bdc 100644
--- a/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts
+++ b/arch/arm/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts
@@ -1871,10 +1871,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disabled";
 };
diff --git a/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts b/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts
index 51c79bf68b79..4dc8160294a4 100644
--- a/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts
+++ b/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts
@@ -1918,10 +1918,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts b/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts
index 0c16793f0a78..759860d7a023 100644
--- a/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts
+++ b/arch/arm/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts
@@ -1919,10 +1919,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/arch/arm64/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts
index 7a977f76940b..d1d05240101d 100644
--- a/arch/arm64/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/g12a_s905d2_u200_drm_buildroot.dts
@@ -828,10 +828,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "okay";
 };
@@ -1479,10 +1475,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm64/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts
index 2f926c1dbd9d..8b2e20f59231 100644
--- a/arch/arm64/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/g12a_s905x2_u212_drm_buildroot.dts
@@ -823,10 +823,6 @@
 	hdcp = "okay";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts
index 701d7b51f4fc..430d1e5cba40 100644
--- a/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot.dts
@@ -911,10 +911,6 @@
 	hdcp = "okay";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts b/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts
index 6c166d22462e..109a04436440 100644
--- a/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts
+++ b/arch/arm64/boot/dts/amlogic/g12b_a311d_w400_drm_buildroot_a.dts
@@ -878,10 +878,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm64/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts
index b614b9bf3159..207a2da06088 100644
--- a/arch/arm64/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/g12b_revb_a311d_w400_drm_buildroot.dts
@@ -882,10 +882,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm64/boot/dts/amlogic/gxl_p212_2g_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/gxl_p212_2g_drm_buildroot.dts
index fe20af58cef2..bebe8464182a 100644
--- a/arch/arm64/boot/dts/amlogic/gxl_p212_2g_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/gxl_p212_2g_drm_buildroot.dts
@@ -1273,10 +1273,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disable";
 };
diff --git a/arch/arm64/boot/dts/amlogic/meson_drm.dtsi b/arch/arm64/boot/dts/amlogic/meson_drm.dtsi
index 7dbea6fb0b7c..bda97c94c997 100644
--- a/arch/arm64/boot/dts/amlogic/meson_drm.dtsi
+++ b/arch/arm64/boot/dts/amlogic/meson_drm.dtsi
@@ -34,22 +34,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -83,11 +67,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm64/boot/dts/amlogic/mesong12a_drm.dtsi b/arch/arm64/boot/dts/amlogic/mesong12a_drm.dtsi
index b200981adb17..12194edbb61d 100644
--- a/arch/arm64/boot/dts/amlogic/mesong12a_drm.dtsi
+++ b/arch/arm64/boot/dts/amlogic/mesong12a_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm64/boot/dts/amlogic/mesong12b_drm.dtsi b/arch/arm64/boot/dts/amlogic/mesong12b_drm.dtsi
index f9a508952367..a5481cf64f3c 100644
--- a/arch/arm64/boot/dts/amlogic/mesong12b_drm.dtsi
+++ b/arch/arm64/boot/dts/amlogic/mesong12b_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm64/boot/dts/amlogic/mesonsm1_drm.dtsi b/arch/arm64/boot/dts/amlogic/mesonsm1_drm.dtsi
index a60f765f3521..26d6393c8809 100644
--- a/arch/arm64/boot/dts/amlogic/mesonsm1_drm.dtsi
+++ b/arch/arm64/boot/dts/amlogic/mesonsm1_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm64/boot/dts/amlogic/mesontl1_drm.dtsi b/arch/arm64/boot/dts/amlogic/mesontl1_drm.dtsi
index ba438194b9a9..ded6053a7ba7 100644
--- a/arch/arm64/boot/dts/amlogic/mesontl1_drm.dtsi
+++ b/arch/arm64/boot/dts/amlogic/mesontl1_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm64/boot/dts/amlogic/mesontm2_drm.dtsi b/arch/arm64/boot/dts/amlogic/mesontm2_drm.dtsi
index a79838750dad..0c753f87aace 100644
--- a/arch/arm64/boot/dts/amlogic/mesontm2_drm.dtsi
+++ b/arch/arm64/boot/dts/amlogic/mesontm2_drm.dtsi
@@ -56,22 +56,6 @@
 		};
 	};
 
-	drm_amcvbsout: drm-amcvbsout {
-		status = "disabled";
-		compatible = "amlogic,drm-cvbsout";
-		dev_name = "meson-amcvbsout";
-		ports {
-			port {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cvbs_in_vpu: endpoint@0 {
-					reg = <0>;
-					remote-endpoint = <&vpu_out_cvbs>;
-				};
-			};
-		};
-	};
-
 	drm_lcd: drm-lcd {
 		status = "disabled";
 		compatible = "amlogic,drm-lcd";
@@ -110,11 +94,7 @@
 				reg = <0>;
 				remote-endpoint = <&hdmi_in_vpu>;
 			};
-			vpu_out_cvbs: endpoint@1 {
-				reg = <0>;
-				remote-endpoint = <&cvbs_in_vpu>;
-			};
-			vpu_out_lcd: endpoint@2 {
+			vpu_out_lcd: endpoint@1 {
 				reg = <1>;
 				remote-endpoint = <&lcd_in_vpu>;
 			};
diff --git a/arch/arm64/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts
index fad000543234..5b10ca8946f0 100644
--- a/arch/arm64/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/sm1_s905d3_ac200_drm_buildroot.dts
@@ -1108,10 +1108,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disabled";
 };
diff --git a/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts b/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts
index 69445182c15c..26b609783e4a 100644
--- a/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts
+++ b/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_1g_drm.dts
@@ -1914,11 +1914,6 @@
 	hdcp = "disabled";
 };
 
-
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts b/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts
index c15a9bbbdbf8..b51254f0c652 100644
--- a/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts
+++ b/arch/arm64/boot/dts/amlogic/tl1_t962x2_x301_2g_drm.dts
@@ -1906,10 +1906,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts b/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts
index 9158e86960a7..60ae1856cf2f 100644
--- a/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts
+++ b/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm.dts
@@ -1866,10 +1866,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disabled";
 };
diff --git a/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts
index e0c963c47934..f21631ac5902 100644
--- a/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/tm2_t962e2_ab311_drm_buildroot.dts
@@ -1867,10 +1867,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "okay";
-};
-
 &drm_lcd {
 	status = "disabled";
 };
diff --git a/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts b/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts
index 1d5bc2b610f5..c25c2f4d5e79 100644
--- a/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts
+++ b/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm.dts
@@ -1913,10 +1913,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts b/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts
index aa136559372f..fe8f1ab73948 100644
--- a/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts
+++ b/arch/arm64/boot/dts/amlogic/tm2_t962x3_ab301_drm_buildroot.dts
@@ -1914,10 +1914,6 @@
 	hdcp = "disabled";
 };
 
-&drm_amcvbsout {
-	status = "disabled";
-};
-
 &drm_lcd {
 	status = "okay";
 };
diff --git a/drivers/amlogic/drm/Kconfig b/drivers/amlogic/drm/Kconfig
index e23fb0982057..74e219a7242f 100644
--- a/drivers/amlogic/drm/Kconfig
+++ b/drivers/amlogic/drm/Kconfig
@@ -58,17 +58,6 @@ config DRM_MESON_HDMI
 		We should confirm AMLOGIC_HDMITX is configured if
 		DRM_MESON_HDMI is selected.
 
-config DRM_MESON_CVBS
-	tristate "support drm cvbs function for meson drm display."
-	default n
-	depends on DRM_MESON
-	depends on AMLOGIC_CVBS_OUTPUT
-	help
-		add drm cvbs support.
-		use internal amlogic media vout cvbs driver.
-		We should confirm AMLOGIC_CVBSOUT is configured if
-		DRM_MESON_CVBS is selected.
-
 config DRM_MESON_PANEL
 	tristate "support drm panel function for meson drm display."
 	default n
diff --git a/drivers/amlogic/drm/Makefile b/drivers/amlogic/drm/Makefile
index d194f0f0b8c8..52b69e95262b 100644
--- a/drivers/amlogic/drm/Makefile
+++ b/drivers/amlogic/drm/Makefile
@@ -15,10 +15,6 @@ ifneq ($(CONFIG_DRM_MESON_HDMI),)
         meson-drm-y += meson_hdmi.o meson_hdcp.o
 endif
 
-ifneq ($(CONFIG_DRM_MESON_CVBS),)
-        meson-drm-y += meson_cvbs.o
-endif
-
 ifneq ($(CONFIG_DRM_MESON_PANEL),)
         meson-drm-y += meson_lcd.o
 endif
diff --git a/drivers/amlogic/drm/meson_cvbs.c b/drivers/amlogic/drm/meson_cvbs.c
deleted file mode 100644
index 7612d67e2003..000000000000
--- a/drivers/amlogic/drm/meson_cvbs.c
+++ /dev/null
@@ -1,338 +0,0 @@
-/*
- * drivers/amlogic/drm/meson_cvbs.c
- *
- * Copyright (C) 2017 Amlogic, Inc. All rights reserved.
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful, but WITHOUT
- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
- * more details.
- *
- */
-
-#include <drm/drm_modeset_helper.h>
-#include <drm/drmP.h>
-#include <drm/drm_crtc_helper.h>
-#include <drm/drm_atomic_helper.h>
-#include <drm/drm_connector.h>
-
-#include <linux/component.h>
-#include <linux/irq.h>
-#include <linux/io.h>
-#include <linux/device.h>
-#include <linux/string.h>
-#include <linux/amlogic/media/vout/vout_notify.h>
-#include <linux/amlogic/media/vout/vinfo.h>
-
-#include "meson_cvbs.h"
-#include <linux/amlogic/media/vout/cvbs_out.h>
-
-static struct drm_display_mode cvbs_mode[] = {
-	{ /* MODE_480CVBS */
-		.name = "480cvbs",
-		.status = 0,
-		.clock = 27000,
-		.hdisplay = 720,
-		.hsync_start = 1390,
-		.hsync_end = 1430,
-		.htotal = 1716,
-		.hskew = 0,
-		.vdisplay = 480,
-		.vsync_start = 725,
-		.vsync_end = 730,
-		.vtotal = 525,
-		.vscan = 0,
-		.vrefresh = 60,
-		.flags = DRM_MODE_FLAG_INTERLACE,
-	},
-	{ /* MODE_576CVBS*/
-		.name = "576cvbs",
-		.status = 0,
-		.clock = 27000,
-		.hdisplay = 720,
-		.hsync_start = 1390,
-		.hsync_end = 1430,
-		.htotal = 1650,
-		.hskew = 0,
-		.vdisplay = 576,
-		.vsync_start = 725,
-		.vsync_end = 730,
-		.vtotal = 750,
-		.vscan = 0,
-		.vrefresh = 60,
-		.flags = DRM_MODE_FLAG_INTERLACE,
-	},
-};
-static struct am_drm_cvbs_s *am_drm_cvbs;
-
-static inline struct am_drm_cvbs_s *con_to_cvbs(struct drm_connector *con)
-{
-	return container_of(con, struct am_drm_cvbs_s, connector);
-}
-
-static inline struct am_drm_cvbs_s *encoder_to_cvbs(struct drm_encoder *encoder)
-{
-	return container_of(encoder, struct am_drm_cvbs_s, encoder);
-}
-
-int am_cvbs_tx_get_modes(struct drm_connector *connector)
-{
-	int i;
-	struct drm_display_mode *mode;
-
-	for (i = 0; i < ARRAY_SIZE(cvbs_mode); i++) {
-		mode = drm_mode_duplicate(connector->dev, &cvbs_mode[i]);
-		if (!mode) {
-			DRM_INFO("[%s:%d]duplicate failed\n", __func__,
-				 __LINE__);
-			return 0;
-		}
-
-		drm_mode_probed_add(connector, mode);
-	}
-
-	return 1;
-}
-
-enum drm_mode_status am_cvbs_tx_check_mode(struct drm_connector *connector,
-					   struct drm_display_mode *mode)
-{
-	int i;
-
-	for (i = 0; i < ARRAY_SIZE(cvbs_mode); i++) {
-		if (cvbs_mode[i].hdisplay == mode->hdisplay &&
-		    cvbs_mode[i].vdisplay == mode->vdisplay &&
-		    cvbs_mode[i].vrefresh == mode->vrefresh)
-			return MODE_OK;
-		else
-			DRM_INFO("hdisplay = %d\nvdisplay = %d\n"
-				 "vrefresh = %d\n", mode->hdisplay,
-				 mode->vdisplay, mode->vrefresh);
-	}
-
-	return MODE_NOMODE;
-}
-
-static struct drm_encoder *am_cvbs_connector_best_encoder
-	(struct drm_connector *connector)
-{
-	struct am_drm_cvbs_s *am_drm_cvbs = con_to_cvbs(connector);
-
-	return &am_drm_cvbs->encoder;
-}
-
-
-static const
-struct drm_connector_helper_funcs am_cvbs_connector_helper_funcs = {
-	.get_modes = am_cvbs_tx_get_modes,
-	.mode_valid = am_cvbs_tx_check_mode,
-	.best_encoder = am_cvbs_connector_best_encoder,
-};
-
-static enum drm_connector_status am_cvbs_connector_detect
-	(struct drm_connector *connector, bool force)
-{
-	return connector_status_connected;
-}
-
-static int am_cvbs_connector_set_property(struct drm_connector *connector,
-	struct drm_property *property, uint64_t val)
-{
-	struct am_drm_cvbs_s *am_drm_cvbs = con_to_cvbs(connector);
-	struct drm_connector_state *state = am_drm_cvbs->connector.state;
-
-	if (property == connector->content_protection_property) {
-		DRM_INFO("property:%s       val: %lld\n", property->name, val);
-		/* For none atomic commit */
-		/* atomic will be filter on drm_moder_object.c */
-		if (val == DRM_MODE_CONTENT_PROTECTION_ENABLED) {
-			DRM_DEBUG_KMS("only drivers can set CP Enabled\n");
-			return -EINVAL;
-		}
-		state->content_protection = val;
-	}
-	/*other parperty todo*/
-	return 0;
-}
-
-static int am_cvbs_connector_atomic_get_property
-	(struct drm_connector *connector,
-	const struct drm_connector_state *state,
-	struct drm_property *property, uint64_t *val)
-{
-	if (property == connector->content_protection_property) {
-		DRM_INFO("get content_protection val: %d\n",
-			state->content_protection);
-		*val = state->content_protection;
-	} else {
-		DRM_DEBUG_ATOMIC("Unknown property %s\n", property->name);
-		return -EINVAL;
-	}
-	return 0;
-}
-
-static void am_cvbs_connector_destroy(struct drm_connector *connector)
-{
-	drm_connector_unregister(connector);
-	drm_connector_cleanup(connector);
-}
-
-static const struct drm_connector_funcs am_cvbs_connector_funcs = {
-	.dpms			= drm_atomic_helper_connector_dpms,
-	.detect			= am_cvbs_connector_detect,
-	.fill_modes		= drm_helper_probe_single_connector_modes,
-	.set_property		= am_cvbs_connector_set_property,
-	.atomic_get_property	= am_cvbs_connector_atomic_get_property,
-	.destroy		= am_cvbs_connector_destroy,
-	.reset			= drm_atomic_helper_connector_reset,
-	.atomic_duplicate_state	= drm_atomic_helper_connector_duplicate_state,
-	.atomic_destroy_state	= drm_atomic_helper_connector_destroy_state,
-};
-
-void am_cvbs_encoder_mode_set(struct drm_encoder *encoder,
-				   struct drm_display_mode *mode,
-				   struct drm_display_mode *adjusted_mode)
-{
-	DRM_INFO("mode : %s, adjusted_mode : %s\n",
-		 mode->name,  adjusted_mode->name);
-
-	get_valid_vinfo(adjusted_mode->name);
-}
-
-void am_cvbs_encoder_enable(struct drm_encoder *encoder)
-{
-	cvbs_set_current_vmode(VMODE_CVBS);
-}
-
-void am_cvbs_encoder_disable(struct drm_encoder *encoder)
-{
-	struct am_drm_cvbs_s *am_drm_cvbs = encoder_to_cvbs(encoder);
-	struct drm_connector_state *state = am_drm_cvbs->connector.state;
-
-	state->content_protection = DRM_MODE_CONTENT_PROTECTION_UNDESIRED;
-}
-
-static const struct drm_encoder_helper_funcs
-	am_cvbs_encoder_helper_funcs = {
-	.mode_set	= am_cvbs_encoder_mode_set,
-	.enable		= am_cvbs_encoder_enable,
-	.disable	= am_cvbs_encoder_disable,
-
-};
-
-static const struct drm_encoder_funcs am_cvbs_encoder_funcs = {
-	.destroy        = drm_encoder_cleanup,
-};
-
-static const struct of_device_id am_meson_cvbs_dt_ids[] = {
-	{ .compatible = "amlogic,drm-cvbsout", },
-	{}
-};
-MODULE_DEVICE_TABLE(of, am_meson_cvbs_dt_ids);
-
-static int am_meson_cvbs_bind(struct device *dev,
-	struct device *master, void *data)
-{
-	struct drm_device *drm = data;
-	struct drm_encoder *encoder;
-	struct drm_connector *connector;
-	int ret = 0;
-
-	DRM_INFO("[%s] in\n", __func__);
-
-	am_drm_cvbs = kzalloc(sizeof(*am_drm_cvbs), GFP_KERNEL);
-	if (!am_drm_cvbs) {
-		DRM_ERROR("[%s,%d] kzalloc failed\n", __func__, __LINE__);
-		return -ENOMEM;
-	}
-
-	am_drm_cvbs->drm = drm;
-	encoder = &am_drm_cvbs->encoder;
-	connector = &am_drm_cvbs->connector;
-
-	/* Encoder */
-	drm_encoder_helper_add(encoder, &am_cvbs_encoder_helper_funcs);
-
-	ret = drm_encoder_init(drm, encoder, &am_cvbs_encoder_funcs,
-			       DRM_MODE_ENCODER_TVDAC, "am_cvbs_encoder");
-	if (ret) {
-		DRM_ERROR("Failed to init cvbs encoder\n");
-		goto cvbs_err;
-	}
-
-	encoder->possible_crtcs = BIT(0);
-
-	/* Connector */
-	drm_connector_helper_add(connector,
-				 &am_cvbs_connector_helper_funcs);
-
-	ret = drm_connector_init(drm, connector, &am_cvbs_connector_funcs,
-				 DRM_MODE_CONNECTOR_TV);
-	if (ret) {
-		DRM_ERROR("Failed to init cvbs OUT connector\n");
-		goto cvbs_err;
-	}
-
-	connector->interlace_allowed = 1;
-
-	ret = drm_mode_connector_attach_encoder(connector, encoder);
-	if (ret) {
-		DRM_ERROR("Failed to init cvbs attach\n");
-		goto cvbs_err;
-	}
-
-	DRM_INFO("[%s] out\n", __func__);
-	return ret;
-
-cvbs_err:
-	kfree(am_drm_cvbs);
-
-	return ret;
-}
-
-static void am_meson_cvbs_unbind(struct device *dev,
-	struct device *master, void *data)
-{
-	am_drm_cvbs->connector.funcs->destroy(&am_drm_cvbs->connector);
-	am_drm_cvbs->encoder.funcs->destroy(&am_drm_cvbs->encoder);
-	kfree(am_drm_cvbs);
-}
-
-static const struct component_ops am_meson_cvbs_ops = {
-	.bind	= am_meson_cvbs_bind,
-	.unbind	= am_meson_cvbs_unbind,
-};
-
-static int am_meson_cvbs_probe(struct platform_device *pdev)
-{
-	DRM_INFO("[%s:%d] in\n", __func__, __LINE__);
-	return component_add(&pdev->dev, &am_meson_cvbs_ops);
-}
-
-static int am_meson_cvbs_remove(struct platform_device *pdev)
-{
-	component_del(&pdev->dev, &am_meson_cvbs_ops);
-	return 0;
-}
-
-static struct platform_driver am_meson_cvbs_pltfm_driver = {
-	.probe  = am_meson_cvbs_probe,
-	.remove = am_meson_cvbs_remove,
-	.driver = {
-		.name = "meson-amcvbsout",
-		.of_match_table = am_meson_cvbs_dt_ids,
-	},
-};
-
-module_platform_driver(am_meson_cvbs_pltfm_driver);
-
-MODULE_AUTHOR("MultiMedia Amlogic <multimedia-sh@amlogic.com>");
-MODULE_DESCRIPTION("Amlogic Meson Drm CVBS driver");
-MODULE_LICENSE("GPL");
-
-
diff --git a/drivers/amlogic/drm/meson_cvbs.h b/drivers/amlogic/drm/meson_cvbs.h
deleted file mode 100644
index 2ac84eea0005..000000000000
--- a/drivers/amlogic/drm/meson_cvbs.h
+++ /dev/null
@@ -1,37 +0,0 @@
-/*
- * drivers/amlogic/drm/meson_cvbs.h
- *
- * Copyright (C) 2017 Amlogic, Inc. All rights reserved.
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful, but WITHOUT
- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
- * more details.
- *
- */
-
-#ifndef __MESON_CVBS_H_
-#define __MESON_CVBS_H_
-
-#include <drm/drm_connector.h>
-#include <drm/drm_encoder.h>
-#include <drm/drm_modes.h>
-
-#include <linux/amlogic/media/vout/vinfo.h>
-
-#include "meson_drv.h"
-
-struct am_drm_cvbs_s {
-	struct drm_device *drm;
-	struct drm_connector connector;
-	struct drm_encoder encoder;
-};
-
-
-
-#endif
diff --git a/drivers/amlogic/drm/meson_vpu.c b/drivers/amlogic/drm/meson_vpu.c
index db1dd79507a1..91102d5d6465 100644
--- a/drivers/amlogic/drm/meson_vpu.c
+++ b/drivers/amlogic/drm/meson_vpu.c
@@ -84,7 +84,6 @@ static struct am_vout_mode am_vout_modes[] = {
 	{ "576p50hz", VMODE_HDMI, 720, 576, 50, 0},
 	{ "576i50hz", VMODE_HDMI, 720, 576, 50, DRM_MODE_FLAG_INTERLACE},
 	{ "480p60hz", VMODE_HDMI, 720, 480, 60, 0},
-	{ "576cvbs", VMODE_CVBS, 720, 576, 60, DRM_MODE_FLAG_INTERLACE},
 };
 
 
diff --git a/drivers/amlogic/media/vout/cvbs/cvbs_mode.h b/drivers/amlogic/media/vout/cvbs/cvbs_mode.h
index 86a0d8acd343..32fd988cc072 100644
--- a/drivers/amlogic/media/vout/cvbs/cvbs_mode.h
+++ b/drivers/amlogic/media/vout/cvbs/cvbs_mode.h
@@ -27,4 +27,6 @@ enum cvbs_mode_e {
 	MODE_MAX,
 };
 
+extern enum cvbs_mode_e get_local_cvbs_mode(void);
+
 #endif
diff --git a/drivers/amlogic/media/vout/cvbs/cvbs_out.c b/drivers/amlogic/media/vout/cvbs/cvbs_out.c
index f671e4f4a33e..e3b13d8582ae 100644
--- a/drivers/amlogic/media/vout/cvbs/cvbs_out.c
+++ b/drivers/amlogic/media/vout/cvbs/cvbs_out.c
@@ -543,7 +543,7 @@ static const struct file_operations am_cvbs_fops = {
 	.poll		= NULL,
 };
 
-const struct vinfo_s *get_valid_vinfo(char  *mode)
+static const struct vinfo_s *get_valid_vinfo(char  *mode)
 {
 	struct vinfo_s *vinfo = NULL;
 	int  i, count = ARRAY_SIZE(cvbs_info);
@@ -570,7 +570,6 @@ const struct vinfo_s *get_valid_vinfo(char  *mode)
 	}
 	return vinfo;
 }
-EXPORT_SYMBOL(get_valid_vinfo);
 
 static struct vinfo_s *cvbs_get_current_info(void)
 {
@@ -583,7 +582,7 @@ enum cvbs_mode_e get_local_cvbs_mode(void)
 }
 EXPORT_SYMBOL(get_local_cvbs_mode);
 
-int cvbs_set_current_vmode(enum vmode_e mode)
+static int cvbs_set_current_vmode(enum vmode_e mode)
 {
 	enum vmode_e tvmode;
 
@@ -612,7 +611,6 @@ int cvbs_set_current_vmode(enum vmode_e mode)
 
 	return 0;
 }
-EXPORT_SYMBOL(cvbs_set_current_vmode);
 
 static enum vmode_e cvbs_validate_vmode(char *mode)
 {
diff --git a/drivers/amlogic/media/vout/cvbs/wss.c b/drivers/amlogic/media/vout/cvbs/wss.c
index 95b31b12f77d..ffcfc36d425a 100644
--- a/drivers/amlogic/media/vout/cvbs/wss.c
+++ b/drivers/amlogic/media/vout/cvbs/wss.c
@@ -29,7 +29,7 @@
 #include <linux/amlogic/media/vout/vout_notify.h>
 #include "wss.h"
 #include "cvbs_out_reg.h"
-#include <linux/amlogic/media/vout/cvbs_out.h>
+#include "cvbs_mode.h"
 
 static const char * const wss_480i_cmd[] = {"ar", "cgms", "psp",
 		"prerec", "CC", "off"};
diff --git a/include/linux/amlogic/media/vout/cvbs_out.h b/include/linux/amlogic/media/vout/cvbs_out.h
deleted file mode 100644
index 729490a8866d..000000000000
--- a/include/linux/amlogic/media/vout/cvbs_out.h
+++ /dev/null
@@ -1,39 +0,0 @@
-/*
- * drivers/amlogic/media/vout/cvbs/cvbs_mode.h
- *
- * Copyright (C) 2017 Amlogic, Inc. All rights reserved.
- *
- * This program is free software; you can redistribute it and/or modify
- * it under the terms of the GNU General Public License as published by
- * the Free Software Foundation; either version 2 of the License, or
- * (at your option) any later version.
- *
- * This program is distributed in the hope that it will be useful, but WITHOUT
- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
- * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
- * more details.
- *
- */
-
-#ifndef _CVBS_OUT_H_
-#define _CVBS_OUT_H_
-
-#include <linux/amlogic/media/vout/vinfo.h>
-
-enum cvbs_mode_e {
-	MODE_480CVBS = 0,
-	MODE_576CVBS,
-	MODE_PAL_M,
-	MODE_PAL_N,
-	MODE_NTSC_M,
-	MODE_MAX,
-};
-
-extern const struct vinfo_s *get_valid_vinfo(char  *mode);
-extern enum cvbs_mode_e get_local_cvbs_mode(void);
-extern int cvbs_set_current_vmode(enum vmode_e mode);
-
-#endif
-
-
-
-- 
2.24.1

