#@TYPE: Machine
#@NAME: meson

#@DESCRIPTION: Machine configuration for meson systems

include conf/machine/include/mesong12a.inc

MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS += " \
        ap6xxx \
        media-modules \
        optee-linux-driver \
        "

MACHINE_EXTRA_RRECOMMENDS = " kernel-modules kernel-devicetree"

EXTRA_IMAGEDEPENDS += "u-boot"

#include conf/machine/include/tune-cortexa53.inc
require conf/machine/include/arm/arch-armv8.inc
require conf/machine/include/amlogic.inc

#DEFAULTTUNE = "cortexa53_64-crypto"

IMAGE_FSTYPES += "tar.gz ext4 cpio.gz"
#IMAGE_FSTYPES += "cpio.gz.u-boot"
#IMAGE_CLASSES += "image_types_uboot"

IMAGE_FSTYPES_DEBUGFS = ""

SERIAL_CONSOLE = "115200 ttyS0"

PREFERRED_PROVIDER_virtual/kernel ?= "linux-meson"

KERNEL_IMAGETYPE = "Image.gz"
KERNEL_DEVICETREE = "g12a_s905x2_u212_buildroot.dtb"

UBOOT_SUFFIX = "bin"
UBOOT_MACHINE = "g12a_u212_v1_config"

MACHINE_FEATURES = "usbgadget usbhost vfat alsa"

IMAGE_BOOT_FILES ?= "u-boot.${UBOOT_SUFFIX}"

INITRAMFS_FILES = "initramfs-default"

KERNEL_MODULE_AUTOLOAD += "mali dhd"
KERNEL_MODULE_PROBECONF += "dhd"
module_conf_dhd = "options dhd firmware_path=/etc/wifi/6398/ nvram_path=/etc/wifi/6398/nvram.txt"
# append drm(wayland drm backend)
DISTRO_FEATURES_append = " drm"
OVERRIDES .= ":u212:g12a"
