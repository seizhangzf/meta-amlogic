#@TYPE: Machine
#@NAME: meson

#@DESCRIPTION: Machine configuration for meson systems

#PREFERRED_PROVIDER_virtual/xserver ?= "xserver-xorg"
#XSERVER ?= "xserver-xorg \
#           xf86-input-evdev \
#           xf86-input-mouse \
#           xf86-video-fbdev \
#           xf86-input-keyboard"

PREFERRED_PROVIDER_virtual/egl = "libgles-drm-32b-wayland"
PREFERRED_PROVIDER_virtual/libgl = "libgles-drm-32b-wayland"
PREFERRED_PROVIDER_virtual/libgles1 = "libgles-drm-32b-wayland"
PREFERRED_PROVIDER_virtual/libgles2 = "libgles-drm-32b-wayland"

MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS += " \
        wififw-bcm4356 \
        "

#MACHINE_EXTRA_RRECOMMENDS = " kernel-modules kernel-devicetree"

#EXTRA_IMAGEDEPENDS += "u-boot"

#include conf/machine/include/tune-cortexa53.inc
require conf/machine/include/tune-cortexa8.inc
require conf/machine/include/amlogic_32b.inc
#DEFAULTTUNE = "cortexa53_32-crypto"

IMAGE_FSTYPES += "tar.gz ext4 cpio.gz"
#IMAGE_FSTYPES += "cpio.gz.u-boot"
#IMAGE_CLASSES += "image_types_uboot"

SERIAL_CONSOLE = "115200 ttyS0"

#PREFERRED_PROVIDER_virtual/kernel ?= "linux-meson"

#KERNEL_IMAGETYPE = "Image.gz"
#KERNEL_DEVICETREE = "gxl_p230_2g.dtb"

#UBOOT_SUFFIX = "bin"
#UBOOT_MACHINE = "gxl_p230_v1_config"

MACHINE_FEATURES = "usbgadget usbhost vfat alsa"

#IMAGE_BOOT_FILES ?= "u-boot.${UBOOT_SUFFIX}"

#INITRAMFS_FILES = "initramfs-default"

KERNEL_MODULE_AUTOLOAD += "mali dhd"
KERNEL_MODULE_PROBECONF += "dhd"
module_conf_dhd = "options dhd firmware_path=/etc/wifi/4356/ nvram_path=/etc/wifi/4356/nvram.txt"
#ROOTFS max in KB
IMAGE_ROOTFS_SIZE_mesongxl_p230_32b = "2097152"
DISTRO_FEATURES_remove += "opengl gl"
DISTRO_FEATURES_remove += "parodus"
VIRTUAL-RUNTIME_alsa-state ?= "alsa-states"
# append drm(wayland drm backend)
DISTRO_FEATURES_append = " drm"
DISTRO_FEATURES_append = " rdkbrowser2"
